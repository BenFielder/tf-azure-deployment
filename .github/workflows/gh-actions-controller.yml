# Do not edit this file directly! It might be overwritten if you run the workflow, You can make changes in "BenFielder/github-actions-controller"
name: Github Actions Controller
on: workflow_dispatch

permissions:
  contents: write
  pull-requests: write
  issues: write
  repository-projects: write

jobs:
    Update-deployment-workflow:
        runs-on: ubuntu-latest
        steps:

            - name: Create branch
              run: |
                    git init
                    git checkout -b gh-actions-controller-update
    
            # Comment or uncomment these depending on what workflows you want to use  
            - name: Pull Github Actions Controller Repo
              uses: actions/checkout@v4
              with:
                repository: "BenFielder/github-actions-controller"
                path: templates
            
            - name: Get all template workflows
              run: |
                mkdir -p .github/workflows
                cp -r templates/templates/Linting/workflows/* .github/workflows/
                cp -r templates/templates/Building/workflows/* .github/workflows/
                cp -r templates/templates/Deploying/workflows/* .github/workflows/
                cp -r templates/templates/Testing/workflows/* .github/workflows/

            # - name: Pull Linting Workflows
            #   uses: actions/checkout@v4
            #   with:
            #     repository: "BenFielder/github-actions-controller"
            #     path: /templates/linting

            # - name: Pull Building Workflows
            #   uses: actions/checkout@v4
            #   with:
            #     repository: "BenFielder/github-actions-controller"
            #     path: /templates/building

            # - name: Pull Testing Workflows
            #   uses: actions/checkout@v4
            #   with:
            #       repository: "BenFielder/github-actions-controller"
            #       path: /templates/testing

            # - name: Pull Deployment Workflows
            #   uses: actions/checkout@v4
            #   with:
            #       repository: "BenFielder/github-actions-controller"
            #       path: /templates/deploying

            - name: Configure user
              run: |
                git config --global user.name "Github Actions Bot"
                git config --global user.email "actions@github.com"     
                  
            - name: Commit changes
              run: |
                git add .
                git commit -m "chore: Update workflows"
          
            - name: Create Pull Request
              run: | 
                gh pr create --base main --head gh-actions-controller-update --title "chore: GH Actions Controller Update" --body "Updating workflows"
              env:
                GH_DEBUG: 1
                GITHUB_TOKEN: ${{ secrets.GH_AC_TOKEN }}
